#!/bin/sh
# --- Pre-Push Git Hook ---
#
# This hook is a final safety net executed before pushing to a remote repository.
# It runs broad, project-wide checks to ensure overall stability.
#
# It performs the following checks:
# 1. Type Checking: Ensures the entire project has no TypeScript errors.
# 2. Production Build: Compiles the Next.js app to catch build-time errors.
#
# NOTE: Linting and formatting are handled by the `pre-commit` hook to provide
# faster feedback to the developer.
#
# If any of these checks fail, the push is aborted.

echo "üöÄ Running Pre-Push Checks..."
echo "--------------------------------------------------------"

# 1. Run the type checker across the entire project
echo "1. Verifying TypeScript types..."
if ! bun run type-check; then
    echo "‚ùå Type check failed. Please fix the type errors and try again."
    exit 1
fi
echo "‚úÖ Type check passed."
echo "--------------------------------------------------------"


# 2. Run a production build to catch any build-time errors
echo "2. Running production build..."
if ! bun run build; then
    echo "‚ùå Production build failed. Please fix the build errors and try again."
    exit 1
fi
echo "‚úÖ Production build successful."
echo "--------------------------------------------------------"

echo "üéâ All pre-push checks passed. Pushing to remote..."

exit 0
