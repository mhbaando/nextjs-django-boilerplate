# --- Pre-Push Git Hook ---
#
# This hook is executed before you push code to a remote repository.
# It's a critical safety net to ensure that code quality standards are met
# before the code is shared with the team.
#
# It performs the following checks:
# 1. Full Project Linting: Verifies the entire codebase for linting errors.
# 2. Type Checking: Ensures the project has no TypeScript errors.
# 3. Production Build: Compiles the Next.js app to catch build-time errors.
#
# If any of these checks fail, the push is aborted.

echo "ğŸš€ Running Pre-Push Checks..."
echo "------------------------------"

# 1. Run the linter across the entire project
echo "ğŸ” Linting codebase..."
if ! bun run lint; then
    echo "âŒ Linter check failed. Please fix the errors and try again."
    exit 1
fi
echo "âœ… Linter check passed."
echo "------------------------------"

# 2. Run the type checker
echo "ğŸ§ Verifying TypeScript types..."
if ! bun run type-check; then
    echo "âŒ Type check failed. Please fix the type errors and try again."
    exit 1
fi
echo "âœ… Type check passed."
echo "------------------------------"

# 3. Run a production build
echo "ğŸ—ï¸  Running production build..."
#
# This command compiles the Next.js application to ensure it can be
# successfully built for production. It's a comprehensive check that can
# catch a wide range of errors, from type issues to configuration problems.

if ! bun run build; then
    echo "âŒ Production build failed. Please fix the build errors and try again."
    exit 1
fi
echo "âœ… Production build successful."
echo "------------------------------"

echo "ğŸ‰ All pre-push checks passed. Pushing to remote..."

exit 0
